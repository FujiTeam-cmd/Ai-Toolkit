<!doctype html>
<html lang="kk">

<head>
  <title>–ê–∫–∫–∞—É–Ω—Ç - Ai-Toolkit</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link href="https://fonts.googleapis.com/css?family=DM+Sans:300,400,700|Indie+Flower" rel="stylesheet">
  
  <link rel="stylesheet" href="fonts/icomoon/style.css">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/bootstrap-datepicker.css">
  <link rel="stylesheet" href="css/jquery.fancybox.min.css">
  <link rel="stylesheet" href="css/owl.carousel.min.css">
  <link rel="stylesheet" href="css/owl.theme.default.min.css">
  <link rel="stylesheet" href="fonts/flaticon/font/flaticon.css">
  <link rel="stylesheet" href="css/aos.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/responsive.css">

  <style>
    .progress-section {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .progress-bar-custom {
      height: 20px;
      border-radius: 10px;
    }
    .history-item {
      border-left: 3px solid #007bff;
      padding-left: 15px;
      margin-bottom: 15px;
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .plan-card {
      border-radius: 10px;
      transition: transform 0.3s;
      margin-bottom: 20px;
    }
    .plan-card:hover {
      transform: translateY(-5px);
    }
    .stats-card {
      text-align: center;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      color: white;
    }
    .login-section, .profile-section {
      display: none;
    }
    .active-section {
      display: block;
    }
    .level-badge {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 5px 15px;
      border-radius: 20px;
      font-weight: bold;
    }
    .goal-item {
      padding: 10px;
      border-bottom: 1px solid #eee;
    }
    .goal-item:last-child {
      border-bottom: none;
    }
    .goal-completed {
      text-decoration: line-through;
      color: #28a745;
    }
    .section-title {
      border-bottom: 2px solid #fd4d40;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }
  </style>
</head>

<body data-spy="scroll" data-target=".site-navbar-target" data-offset="300">
  
  <div class="site-wrap" id="home-section">

     <div class="site-mobile-menu site-navbar-target">
        <div class="site-mobile-menu-header">
          <div class="site-mobile-menu-close mt-3">
            <span class="icon-close2 js-menu-toggle"></span>
          </div>
        </div>
        <div class="site-mobile-menu-body"></div>
     </div>
     
    <header class="site-navbar site-navbar-target" role="banner">
      <div class="container mb-3">
        <div class="d-flex align-items-center">
          <div class="site-logo mr-auto">
            <a href="index_kk.html">Ai-Toolkit<span class="text-primary">.</span></a>
          </div>
          <div class="site-quick-contact d-none d-lg-flex ml-auto ">
            <div class="d-flex site-info align-items-center mr-5">
              <span class="block-icon mr-3"><span class="icon-map-marker text-yellow"></span></span>
              <span>–®–µ—Ä—Ö–∞–Ω –ú“±—Ä—Ç–∞–∑–∞ –∞—Ç—ã–Ω–¥–∞“ì—ã –º–µ–∫—Ç–µ–ø <br>–¢–∞—Ä–∞–∑</span>
            </div>
            <div class="d-flex site-info align-items-center">
              <span class="block-icon mr-3"><span class="icon-clock-o"></span></span>
              <span>”ò–∑—ñ—Ä–ª–µ—É –∫–µ–∑–µ“£—ñ–Ω–¥–µ<br> </span>
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="menu-wrap d-flex align-items-center">
          <span class="d-inline-block d-lg-none"><a href="#" class="text-black site-menu-toggle js-menu-toggle py-5"><span class="icon-menu h3 text-black"></span></a></span>

          <nav class="site-navigation text-left mr-auto d-none d-lg-block" role="navigation">
            <ul class="site-menu main-menu js-clone-nav mr-auto ">
                  <li><a href="index_kk.html" class="nav-link">–ë–∞—Å—Ç—ã –±–µ—Ç</a></li>
                  <li><a href="chat_kk.html" class="nav-link">AI –ö”©–º–µ–∫—à—ñ</a></li>
                  <li><a href="test_kk.html" class="nav-link">–¢–µ—Å—Ç –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã</a></li>
                  <li><a href="img_kk.html" class="nav-link">–ö–æ–Ω—Ç–µ–Ω—Ç –Ü–∑–¥–µ—É</a></li>
                  <li><a href="contact_kk.html" class="nav-link">–ë–∞–π–ª–∞–Ω—ã—Å</a></li>
                  <li><a href="edu_kk.html" class="nav-link">–ë—ñ–ª—ñ–º</a></li>
                  <li class="active"><a href="acc_kk.html" class="nav-link">–ê–∫–∫–∞—É–Ω—Ç</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </header>

    <div class="ftco-blocks-cover-1">
      <div class="site-section-cover overlay" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-md-8 mt-5 pt-5">
              <span class="text-cursive h5 text-white">“ö–∞–π—Ç–∞ –æ—Ä–∞–ª–¥—ã“£—ã–∑!</span>
              <h1 class="mb-3 font-weight-bold text-white">–°—ñ–∑–¥—ñ“£ –û“õ—É –ë–∞—Å“õ–∞—Ä—É –ü–∞–Ω–µ–ª—ñ“£—ñ–∑</h1>
              <p class="text-white">–ü—Ä–æ–≥—Ä–µ—Å—Å—ñ“£—ñ–∑–¥—ñ –±–∞“õ—ã–ª–∞“£—ã–∑ –∂”ô–Ω–µ –∂–µ–∫–µ–ª–µ–Ω–¥—ñ—Ä—ñ–ª–≥–µ–Ω –æ“õ—É –∂–æ—Å–ø–∞—Ä—ã“£—ã–∑–¥—ã “±—Å—Ç–∞–Ω—ã“£—ã–∑</p>
            </div>
            <div class="col-md-4 ml-auto align-self-end">
              <img src="images/user_dashboard.png" alt="Image" class="img-fluid">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –ö—ñ—Ä—É/–¢—ñ—Ä–∫–µ–ª—É –±”©–ª—ñ–º—ñ -->
    <div class="site-section bg-light login-section active-section" id="login-section">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-md-6">
            <div class="card shadow-sm">
              <div class="card-body p-5">
                <h3 class="text-center mb-4">Ai-Toolkit-–∫–µ “õ–æ—à –∫–µ–ª–¥—ñ“£—ñ–∑</h3>
                
                <div class="text-center mb-4">
                  <button class="btn btn-primary mr-2" id="showLoginBtn">–ö—ñ—Ä—É</button>
                  <button class="btn btn-outline-primary" id="showRegisterBtn">–¢—ñ—Ä–∫–µ–ª—É</button>
                </div>

                <!-- –ö—ñ—Ä—É —Ñ–æ—Ä–º–∞—Å—ã -->
                <form id="loginForm">
                  <h4 class="text-center mb-4">–ê–∫–∫–∞—É–Ω—Ç—ã“£—ã–∑“ì–∞ –∫—ñ—Ä—ñ“£—ñ–∑</h4>
                  <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-control" id="loginEmail" required>
                  </div>
                  <div class="form-group">
                    <label>“ö“±–ø–∏—è —Å”©–∑</label>
                    <input type="password" class="form-control" id="loginPassword" required>
                  </div>
                  <button type="submit" class="btn btn-primary btn-block">–ö—ñ—Ä—É</button>
                </form>

                <!-- –¢—ñ—Ä–∫–µ–ª—É —Ñ–æ—Ä–º–∞—Å—ã -->
                <form id="registerForm" style="display: none;">
                  <h4 class="text-center mb-4">–ñ–∞“£–∞ –ê–∫–∫–∞—É–Ω—Ç –ñ–∞—Å–∞—É</h4>
                  <div class="form-group">
                    <label>–ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã –∞—Ç—ã</label>
                    <input type="text" class="form-control" id="registerUsername" required>
                  </div>
                  <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-control" id="registerEmail" required>
                  </div>
                  <div class="form-group">
                    <label>“ö“±–ø–∏—è —Å”©–∑</label>
                    <input type="password" class="form-control" id="registerPassword" required>
                  </div>
                  <div class="form-group">
                    <label>–°—ã–Ω—ã–ø –¥–µ“£–≥–µ–π—ñ</label>
                    <select class="form-control" id="registerGrade">
                      <option value="5">5-—Å—ã–Ω—ã–ø</option>
                      <option value="6">6-—Å—ã–Ω—ã–ø</option>
                      <option value="7">7-—Å—ã–Ω—ã–ø</option>
                    </select>
                  </div>
                  <button type="submit" class="btn btn-primary btn-block">–ê–∫–∫–∞—É–Ω—Ç –ñ–∞—Å–∞—É</button>
                </form>

                <div id="authMessage" class="mt-3"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –ù–µ–≥—ñ–∑–≥—ñ –ø—Ä–æ—Ñ–∏–ª—å –±”©–ª—ñ–º—ñ -->
    <div class="site-section bg-light profile-section" id="profile-section">
      <div class="container">
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="row mb-5">
          <div class="col-12">
            <h2 class="section-title">–°—ñ–∑–¥—ñ“£ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞“£—ã–∑</h2>
          </div>
          <div class="col-md-3">
            <div class="stats-card bg-primary">
              <h2 id="completedLessons">0</h2>
              <p>–ê—è“õ—Ç–∞–ª“ì–∞–Ω –°–∞–±–∞“õ—Ç–∞—Ä</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stats-card bg-success">
              <h2 id="averageScore">0%</h2>
              <p>–û—Ä—Ç–∞—à–∞ –ë–∞–ª–ª</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stats-card bg-warning text-dark">
              <h2 id="currentStreak">0</h2>
              <p>–ê“ì—ã–º–¥–∞“ì—ã –°—Ç—Ä–∏–∫</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stats-card bg-info">
              <h2 id="aiRequestsToday">0</h2>
              <p>–ë“Ø–≥—ñ–Ω AI –°“±—Ä–∞–Ω—ã—Å—Ç–∞—Ä—ã</p>
            </div>
          </div>
        </div>

        <!-- –ü—Ä–æ—Ñ–∏–ª—å –∂”ô–Ω–µ –ø—Ä–æ–≥—Ä–µ—Å—Å -->
        <div class="row">
          <div class="col-md-4 mb-4">
            <div class="card shadow-sm">
              <div class="card-body text-center">
                <img src="images/user.jpg" alt="User" class="rounded-circle mb-3" width="120">
                <h3 class="card-title" id="profileUsername">–ñ“Ø–∫—Ç–µ–ª—É–¥–µ...</h3>
                <p class="text-muted" id="profileEmail">–ñ“Ø–∫—Ç–µ–ª—É–¥–µ...</p>
                <div class="mb-3">
                  <span class="level-badge" id="profileLevel">1-–¥–µ“£–≥–µ–π</span>
                  <span class="badge badge-success p-2 ml-1">–ë–µ–ª—Å–µ–Ω–¥—ñ</span>
                </div>
                <div class="progress mb-2">
                  <div class="progress-bar bg-warning" id="experienceBar" role="progressbar" style="width: 0%"></div>
                </div>
                <small class="text-muted" id="experienceText">–ö–µ–ª–µ—Å—ñ –¥–µ“£–≥–µ–π–≥–µ 0/100 XP</small>
                <p class="card-text mt-3" id="profileJoined">“ö–æ—Å—ã–ª–¥—ã: –ñ“Ø–∫—Ç–µ–ª—É–¥–µ...</p>
                <button class="btn btn-outline-primary btn-sm" id="logoutBtn">–®—ã“ì—É</button>
              </div>
            </div>
          </div>
          
          <div class="col-md-8">
            <div class="card shadow-sm">
              <div class="card-body">
                <h4 class="section-title">–û“õ—É –ü—Ä–æ–≥—Ä–µ—Å—Å—ñ</h4>
                <div class="row">
                  <div class="col-md-6">
                    <div class="progress-section">
                      <h5>–ë–∞“ì–¥–∞—Ä–ª–∞–º–∞–ª–∞—É –ù–µ–≥—ñ–∑–¥–µ—Ä—ñ</h5>
                      <div class="progress mb-3">
                        <div class="progress-bar bg-success progress-bar-custom" id="progressProgramming" role="progressbar" style="width: 0%"></div>
                      </div>
                      <p id="progressProgrammingText">–ê—è“õ—Ç–∞–ª–¥—ã: 0/20 —Å–∞–±–∞“õ</p>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="progress-section">
                      <h5>–ê–ª–≥–æ—Ä–∏—Ç–º–¥–µ—Ä & –î–µ—Ä–µ–∫—Ç–µ—Ä “ö“±—Ä—ã–ª—ã–º—ã</h5>
                      <div class="progress mb-3">
                        <div class="progress-bar bg-info progress-bar-custom" id="progressAlgorithms" role="progressbar" style="width: 0%"></div>
                      </div>
                      <p id="progressAlgorithmsText">–ê—è“õ—Ç–∞–ª–¥—ã: 0/20 —Å–∞–±–∞“õ</p>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="progress-section">
                      <h5>–í–µ–± ”ò–∑—ñ—Ä–ª–µ—É</h5>
                      <div class="progress mb-3">
                        <div class="progress-bar bg-warning progress-bar-custom" id="progressWeb" role="progressbar" style="width: 0%"></div>
                      </div>
                      <p id="progressWebText">–ê—è“õ—Ç–∞–ª–¥—ã: 0/20 —Å–∞–±–∞“õ</p>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="progress-section">
                      <h5>–î–µ—Ä–µ–∫“õ–æ—Ä –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—ñ</h5>
                      <div class="progress mb-3">
                        <div class="progress-bar bg-danger progress-bar-custom" id="progressDatabases" role="progressbar" style="width: 0%"></div>
                      </div>
                      <p id="progressDatabasesText">–ê—è“õ—Ç–∞–ª–¥—ã: 0/20 —Å–∞–±–∞“õ</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- –û“õ—É –∂–æ—Å–ø–∞—Ä–ª–∞—Ä—ã -->
        <div class="row mt-5">
          <div class="col-md-6">
            <div class="card plan-card shadow-sm border-warning">
              <div class="card-header bg-warning text-white">
                <h4 class="mb-0">üìÖ –ê–ø—Ç–∞–ª—ã“õ –ñ–æ—Å–ø–∞—Ä</h4>
              </div>
              <div class="card-body">
                <h5 class="card-title">–û—Å—ã –ê–ø—Ç–∞–Ω—ã“£ –ú–∞“õ—Å–∞—Ç—Ç–∞—Ä—ã</h5>
                <div class="progress mb-3">
                  <div class="progress-bar bg-warning" id="weeklyProgress" role="progressbar" style="width: 0%"></div>
                </div>
                <p class="text-muted" id="weeklyProgressText">–ê–ø—Ç–∞–ª—ã“õ –º–∞“õ—Å–∞—Ç—Ç–∞—Ä–¥—ã“£ 0% –æ—Ä—ã–Ω–¥–∞–ª–¥—ã</p>
                
                <div id="weeklyGoalsList">
                  <!-- Goals will be populated by JavaScript -->
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="card plan-card shadow-sm border-danger">
              <div class="card-header bg-danger text-white">
                <h4 class="mb-0">üìä –ê–π–ª—ã“õ –ñ–æ—Å–ø–∞—Ä</h4>
              </div>
              <div class="card-body">
                <h5 class="card-title">–û—Å—ã –ê–π–¥—ã“£ –ú–∞“õ—Å–∞—Ç—Ç–∞—Ä—ã</h5>
                <div class="progress mb-3">
                  <div class="progress-bar bg-danger" id="monthlyProgress" role="progressbar" style="width: 0%"></div>
                </div>
                <p class="text-muted" id="monthlyProgressText">–ê–π–ª—ã“õ –º–∞“õ—Å–∞—Ç—Ç–∞—Ä–¥—ã“£ 0% –æ—Ä—ã–Ω–¥–∞–ª–¥—ã</p>
                
                <div id="monthlyGoalsList">
                  <!-- Goals will be populated by JavaScript -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ”ò—Ä–µ–∫–µ—Ç —Ç–∞—Ä–∏—Ö—ã -->
        <div class="row mt-5">
          <div class="col-12">
            <div class="card shadow-sm">
              <div class="card-body">
                <h4 class="section-title">üìù –°–æ“£“ì—ã ”ò—Ä–µ–∫–µ—Ç—Ç–µ—Ä</h4>
                <div id="historyContainer">
                  <p class="text-muted text-center">”ò–ª—ñ ”ô—Ä–µ–∫–µ—Ç —Ç–∞—Ä–∏—Ö—ã –∂–æ“õ.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer class="site-footer">
      <div class="container">
        <div class="row">
          <div class="col-lg-4">
            <h2 class="footer-heading mb-3">–ë—ñ–∑ —Ç—É—Ä–∞–ª—ã</h2>
            <p class="mb-5">–û“õ—É “õ—ã–∑—ã“õ—Ç—ã –±–æ–ª—É—ã –º“Ø–º–∫—ñ–Ω –¥–µ–ø —Å–µ–Ω–µ—Ç—ñ–Ω –∞–¥–∞–º–¥–∞—Ä</p>

            <h2 class="footer-heading mb-4">–ñ–∞“£–∞–ª—ã“õ—Ç–∞—Ä</h2>
            <form action="#" class="d-flex" class="subscribe">
              <input type="text" class="form-control mr-3" placeholder="Email">
              <a type="submit" class="btn btn-primary" href="contact_kk.html" style="align-items: center; padding-top: 15px; ">–ñ—ñ–±–µ—Ä—É</a>
            </form>
          </div>
          <div class="col-lg-8 ml-auto">
            <div class="row">
              <div class="col-lg-4 ml-auto">
                <h2 class="footer-heading mb-4">–ù–∞–≤–∏–≥–∞—Ü–∏—è</h2>
                <ul class="list-unstyled">
                  <li><a href="index_kk.html#Aboutus">–ë—ñ–∑ —Ç—É—Ä–∞–ª—ã</a></li>
                  <li><a href="chat_kk.html">AI –ö”©–º–µ–∫—à—ñ</a></li>
                  <li><a href="index_kk.html#Testimonials">–ü—ñ–∫—ñ—Ä–ª–µ—Ä</a></li>
                  <li><a href="contact_kk.html">–ë–∞–π–ª–∞–Ω—ã—Å</a></li>
                  <li><a href="index_kk.html#plan">–ñ–æ—Å–ø–∞—Ä</a></li>
                  <li><a href="index_kk.html#functional">–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª</a></li>
                  <li><a href="index_kk.html#pros">–ê—Ä—Ç—ã“õ—à—ã–ª—ã“õ—Ç–∞—Ä</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="row pt-5 mt-5 text-center">
          <div class="col-md-12">
            <div class="border-top pt-5">
            </div>
          </div>
        </div>
      </div>
    </footer>
  </div>

  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/jquery-migrate-3.0.0.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/jquery.sticky.js"></script>
  <script src="js/jquery.waypoints.min.js"></script>
  <script src="js/jquery.animateNumber.min.js"></script>
  <script src="js/jquery.fancybox.min.js"></script>
  <script src="js/jquery.stellar.min.js"></script>
  <script src="js/jquery.easing.1.3.js"></script>
  <script src="js/bootstrap-datepicker.min.js"></script>
  <script src="js/aos.js"></script>
  <script src="js/main.js"></script>
  <script src="js/responsive.js"></script>

<script>
  class AccountSystem {
    constructor() {
      this.currentUser = null;
      this.token = null;
      this.init();
    }

    init() {
      this.setupEventListeners();
      this.checkExistingLogin();
    }

    setupEventListeners() {
      document.getElementById('showLoginBtn').addEventListener('click', () => this.showLogin());
      document.getElementById('showRegisterBtn').addEventListener('click', () => this.showRegister());
      document.getElementById('loginForm').addEventListener('submit', (e) => this.handleLogin(e));
      document.getElementById('registerForm').addEventListener('submit', (e) => this.handleRegister(e));
      document.getElementById('logoutBtn').addEventListener('click', () => this.handleLogout());
    }

    showLogin() {
      document.getElementById('loginForm').style.display = 'block';
      document.getElementById('registerForm').style.display = 'none';
      document.getElementById('showLoginBtn').classList.add('btn-primary');
      document.getElementById('showLoginBtn').classList.remove('btn-outline-primary');
      document.getElementById('showRegisterBtn').classList.add('btn-outline-primary');
      document.getElementById('showRegisterBtn').classList.remove('btn-primary');
    }

    showRegister() {
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('registerForm').style.display = 'block';
      document.getElementById('showRegisterBtn').classList.add('btn-primary');
      document.getElementById('showRegisterBtn').classList.remove('btn-outline-primary');
      document.getElementById('showLoginBtn').classList.add('btn-outline-primary');
      document.getElementById('showLoginBtn').classList.remove('btn-primary');
    }

    async handleLogin(e) {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;

      try {
        const response = await fetch('/api/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        });

        const data = await response.json();

        if (data.success) {
          this.currentUser = data.user;
          this.token = data.token;
          this.saveToLocalStorage();
          this.showProfile();
          await this.loadUserData();
          this.showMessage('–ö—ñ—Ä—É —Å”ô—Ç—Ç—ñ!', 'success');
        } else {
          this.showMessage(data.error, 'danger');
        }
      } catch (error) {
        this.showMessage('–ö—ñ—Ä—É —Å”ô—Ç—Å—ñ–∑: ' + error.message, 'danger');
      }
    }

    async handleRegister(e) {
      e.preventDefault();
      const username = document.getElementById('registerUsername').value;
      const email = document.getElementById('registerEmail').value;
      const password = document.getElementById('registerPassword').value;
      const grade = document.getElementById('registerGrade').value;

      try {
        const response = await fetch('/api/register', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, email, password, grade })
        });

        const data = await response.json();

        if (data.success) {
          this.currentUser = data.user;
          this.token = data.token;
          this.saveToLocalStorage();
          this.showProfile();
          await this.loadUserData();
          this.showMessage('–ê–∫–∫–∞—É–Ω—Ç —Å”ô—Ç—Ç—ñ –∂–∞—Å–∞–ª–¥—ã!', 'success');
        } else {
          this.showMessage(data.error, 'danger');
        }
      } catch (error) {
        this.showMessage('–¢—ñ—Ä–∫–µ–ª—É —Å”ô—Ç—Å—ñ–∑: ' + error.message, 'danger');
      }
    }

    showProfile() {
      document.querySelector('.login-section').classList.remove('active-section');
      document.querySelector('.profile-section').classList.add('active-section');
    }

    showLoginForm() {
      document.querySelector('.login-section').classList.add('active-section');
      document.querySelector('.profile-section').classList.remove('active-section');
    }

    async loadUserData() {
      if (!this.currentUser || !this.token) return;

      try {
        // –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–Ω—ã“£ –∂–∞“£–∞ –¥–µ—Ä–µ–∫—Ç–µ—Ä—ñ–Ω –∂“Ø–∫—Ç–µ—É
        const userResponse = await fetch('/api/user', {
          headers: {
            'Authorization': `Bearer ${this.token}`
          }
        });
        
        if (!userResponse.ok) {
          throw new Error('–ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã –¥–µ—Ä–µ–∫—Ç–µ—Ä—ñ–Ω –∂“Ø–∫—Ç–µ—É —Å”ô—Ç—Å—ñ–∑');
        }
        
        const userData = await userResponse.json();

        // –î–µ“£–≥–µ–π —Ç—É—Ä–∞–ª—ã –∞“õ–ø–∞—Ä–∞—Ç—Ç—ã –∂“Ø–∫—Ç–µ—É
        const levelResponse = await fetch('/api/level-info', {
          headers: {
            'Authorization': `Bearer ${this.token}`
          }
        });
        
        let levelInfo = {};
        if (levelResponse.ok) {
          levelInfo = await levelResponse.json();
        }

        // –¢–∞—Ä–∏—Ö—Ç—ã –∂“Ø–∫—Ç–µ—É
        const historyResponse = await fetch('/api/history', {
          headers: {
            'Authorization': `Bearer ${this.token}`
          }
        });
        
        const history = historyResponse.ok ? await historyResponse.json() : [];

        // –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—Ç—ñ –∂–∞“£–∞—Ä—Ç—É
        this.updateProfileUI(userData, levelInfo);
        this.updateStatsUI(userData.stats);
        this.updateProgressUI(userData.stats);
        this.displayHistory(history);
        this.updateLearningPlans(userData.stats);

      } catch (error) {
        console.error('–ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã –¥–µ—Ä–µ–∫—Ç–µ—Ä—ñ–Ω –∂“Ø–∫—Ç–µ—É “õ–∞—Ç–µ—Å—ñ:', error);
        this.showMessage('–î–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –∂“Ø–∫—Ç–µ—É “õ–∞—Ç–µ—Å—ñ: ' + error.message, 'danger');
      }
    }

    updateProfileUI(userData, levelInfo) {
      document.getElementById('profileUsername').textContent = userData.username;
      document.getElementById('profileEmail').textContent = userData.email;
      
      // –î–µ“£–≥–µ–π —Ç—É—Ä–∞–ª—ã –∞“õ–ø–∞—Ä–∞—Ç—Ç—ã –ø–∞–π–¥–∞–ª–∞–Ω—É
      const level = levelInfo.level || userData.level || 1;
      const currentExp = levelInfo.currentLevelExp || (userData.experience % 100) || 0;
      const expToNext = levelInfo.expToNextLevel || (100 - currentExp);
      
      document.getElementById('profileLevel').textContent = `${level}-–¥–µ“£–≥–µ–π`;
      document.getElementById('profileJoined').textContent = `“ö–æ—Å—ã–ª–¥—ã: ${new Date(userData.joined).toLocaleDateString()}`;
      
      // –¢”ô–∂—ñ—Ä–∏–±–µ –ø—Ä–æ–≥—Ä–µ—Å—Å—ñ
      const expPercent = currentExp;
      document.getElementById('experienceBar').style.width = `${expPercent}%`;
      document.getElementById('experienceText').textContent = `–ö–µ–ª–µ—Å—ñ –¥–µ“£–≥–µ–π–≥–µ ${currentExp}/${expToNext + currentExp} XP`;
      
      // –ê“ì—ã–º–¥–∞“ì—ã –ø–∞–π–¥–∞–ª–∞–Ω—É—à—ã–Ω—ã –∂–∞“£–∞—Ä—Ç—É
      if (this.currentUser) {
        this.currentUser.level = level;
        this.currentUser.experience = userData.experience;
        this.saveToLocalStorage();
      }
    }

    updateStatsUI(stats) {
      // –ê—è“õ—Ç–∞–ª“ì–∞–Ω —Å–∞–±–∞“õ—Ç–∞—Ä
      document.getElementById('completedLessons').textContent = stats.completedLessons || 0;
      
      // –û—Ä—Ç–∞—à–∞ –±–∞–ª–ª
      const averageScore = stats.testsTaken > 0 ? Math.round(stats.totalScore / stats.testsTaken) : 0;
      document.getElementById('averageScore').textContent = `${averageScore}%`;
      
      // –ê“ì—ã–º–¥–∞“ì—ã —Å—Ç—Ä–∏–∫
      document.getElementById('currentStreak').textContent = stats.currentStreak || 0;
      
      // –ë“Ø–≥—ñ–Ω AI —Å“±—Ä–∞–Ω—ã—Å—Ç–∞—Ä—ã
      const today = new Date().toDateString();
      const aiRequestsToday = stats.dailyRequests ? (stats.dailyRequests[today] || 0) : 0;
      document.getElementById('aiRequestsToday').textContent = aiRequestsToday;
    }

    updateProgressUI(stats) {
      const progress = stats.progress || {};
      
      // –ë–∞“ì–¥–∞—Ä–ª–∞–º–∞–ª–∞—É
      const programmingProgress = progress.programming || 0;
      document.getElementById('progressProgramming').style.width = `${programmingProgress}%`;
      document.getElementById('progressProgrammingText').textContent = 
        `–ê—è“õ—Ç–∞–ª–¥—ã: ${Math.round(programmingProgress / 5)}/20 —Å–∞–±–∞“õ`;
      
      // –ê–ª–≥–æ—Ä–∏—Ç–º–¥–µ—Ä
      const algorithmsProgress = progress.algorithms || 0;
      document.getElementById('progressAlgorithms').style.width = `${algorithmsProgress}%`;
      document.getElementById('progressAlgorithmsText').textContent = 
        `–ê—è“õ—Ç–∞–ª–¥—ã: ${Math.round(algorithmsProgress / 5)}/20 —Å–∞–±–∞“õ`;
      
      // –í–µ–±-”ô–∑—ñ—Ä–ª–µ—É
      const webProgress = progress.web || 0;
      document.getElementById('progressWeb').style.width = `${webProgress}%`;
      document.getElementById('progressWebText').textContent = 
        `–ê—è“õ—Ç–∞–ª–¥—ã: ${Math.round(webProgress / 5)}/20 —Å–∞–±–∞“õ`;
      
      // –î–µ—Ä–µ–∫“õ–æ—Ä–ª–∞—Ä
      const databasesProgress = progress.databases || 0;
      document.getElementById('progressDatabases').style.width = `${databasesProgress}%`;
      document.getElementById('progressDatabasesText').textContent = 
        `–ê—è“õ—Ç–∞–ª–¥—ã: ${Math.round(databasesProgress / 5)}/20 —Å–∞–±–∞“õ`;
    }

    updateLearningPlans(stats) {
      const weeklyProgress = this.calculateWeeklyProgress(stats);
      document.getElementById('weeklyProgress').style.width = `${weeklyProgress}%`;
      document.getElementById('weeklyProgressText').textContent = `–ê–ø—Ç–∞–ª—ã“õ –º–∞“õ—Å–∞—Ç—Ç–∞—Ä–¥—ã“£ ${weeklyProgress}% –æ—Ä—ã–Ω–¥–∞–ª–¥—ã`;
      
      const monthlyProgress = this.calculateMonthlyProgress(stats);
      document.getElementById('monthlyProgress').style.width = `${monthlyProgress}%`;
      document.getElementById('monthlyProgressText').textContent = `–ê–π–ª—ã“õ –º–∞“õ—Å–∞—Ç—Ç–∞—Ä–¥—ã“£ ${monthlyProgress}% –æ—Ä—ã–Ω–¥–∞–ª–¥—ã`;
      
      this.updateGoalsLists(stats);
    }

    calculateWeeklyProgress(stats) {
      const today = new Date();
      let activeDays = 0;
      
      if (stats.dailyRequests) {
        for (let i = 0; i < 7; i++) {
          const date = new Date();
          date.setDate(today.getDate() - i);
          const dateString = date.toDateString();
          if (stats.dailyRequests[dateString] > 0) {
            activeDays++;
          }
        }
      }
      
      return Math.min(100, Math.round((activeDays / 7) * 100));
    }

    calculateMonthlyProgress(stats) {
      const progress = stats.progress || {};
      const totalProgress = (progress.programming || 0) + (progress.algorithms || 0) + 
                          (progress.web || 0) + (progress.databases || 0);
      const maxPossible = 400;
      return Math.round((totalProgress / maxPossible) * 100);
    }

    updateGoalsLists(stats) {
      const weeklyGoals = [
        "–ö–µ–º –¥–µ–≥–µ–Ω–¥–µ 3 AI-–∫”©–º–µ–∫—à—ñ —Å–∞–±–∞“õ—Ç—ã –∞—è“õ—Ç–∞—É",
        "–ë—ñ—Ä –ø—Ä–∞–∫—Ç–∏–∫–∞–ª—ã“õ —Ç–µ—Å—Ç —Ç–∞–ø—Å—ã—Ä—É",
        "–ó–µ—Ä—Ç—Ç–µ—É “Ø—à—ñ–Ω –∫–æ–Ω—Ç–µ–Ω—Ç —ñ–∑–¥–µ—É–¥—ñ –ø–∞–π–¥–∞–ª–∞–Ω—É",
        "3-–∫“Ø–Ω–¥—ñ–∫ –æ“õ—É —Å—Ç—Ä–∏–≥—ñ–Ω —Å–∞“õ—Ç–∞—É"
      ];
      
      const monthlyGoals = [
        "5-–¥–µ“£–≥–µ–π–≥–µ –∂–µ—Ç—É",
        "–ë–∞“ì–¥–∞—Ä–ª–∞–º–∞–ª–∞—É –Ω–µ–≥—ñ–∑–¥–µ—Ä—ñ–Ω –∞—è“õ—Ç–∞—É (50%)",
        "80% –æ—Ä—Ç–∞—à–∞ —Ç–µ—Å—Ç –±–∞–ª–ª—ã–Ω–∞ –∂–µ—Ç—É",
        "–ë–∞—Ä–ª—ã“õ AI “õ“±—Ä–∞–ª–¥–∞—Ä—ã–Ω –∫–µ–º –¥–µ–≥–µ–Ω–¥–µ –±—ñ—Ä —Ä–µ—Ç –ø–∞–π–¥–∞–ª–∞–Ω—É"
      ];
      
      this.renderGoalsList('weeklyGoalsList', weeklyGoals, this.calculateWeeklyProgress(stats));
      this.renderGoalsList('monthlyGoalsList', monthlyGoals, this.calculateMonthlyProgress(stats));
    }

    renderGoalsList(containerId, goals, progress) {
      const container = document.getElementById(containerId);
      const completedCount = Math.floor((progress / 100) * goals.length);
      
      let html = '';
      goals.forEach((goal, index) => {
        const isCompleted = index < completedCount;
        html += `
          <div class="goal-item ${isCompleted ? 'goal-completed' : ''}">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" ${isCompleted ? 'checked' : ''} disabled>
              <label class="form-check-label">${goal}</label>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    async displayHistory(history) {
      const historyContainer = document.getElementById('historyContainer');
      
      if (history.length === 0) {
        historyContainer.innerHTML = '<p class="text-muted text-center">”ò–ª—ñ ”ô—Ä–µ–∫–µ—Ç —Ç–∞—Ä–∏—Ö—ã –∂–æ“õ. AI “õ“±—Ä–∞–ª–¥–∞—Ä—ã–Ω –ø–∞–π–¥–∞–ª–∞–Ω–∞ –±–∞—Å—Ç–∞“£—ã–∑, ”ô—Ä–µ–∫–µ—Ç—Ç–µ—Ä—ñ“£—ñ–∑ –æ—Å—ã–Ω–¥–∞ –ø–∞–π–¥–∞ –±–æ–ª–∞–¥—ã!</p>';
        return;
      }

      let html = '';
      history.slice(0, 10).forEach(item => {
        const date = new Date(item.timestamp);
        const timeString = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
        
        html += `
          <div class="history-item">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <strong>${this.getActivityType(item.type)}</strong>
                <p class="mb-1"><strong>–¢–∞“õ—ã—Ä—ã–ø:</strong> ${item.topic}</p>
                ${this.formatActivityDetails(item)}
              </div>
              <small class="text-muted">${timeString}</small>
            </div>
          </div>
        `;
      });

      historyContainer.innerHTML = html;
    }

    getActivityType(type) {
      const types = {
        'chat': 'ü§ñ AI –ö”©–º–µ–∫—à—ñ –°“±—Ö–±–∞—Ç—ã',
        'test': 'üìù –ü—Ä–∞–∫—Ç–∏–∫–∞–ª—ã“õ –¢–µ—Å—Ç',
        'content-search': 'üîç –ö–æ–Ω—Ç–µ–Ω—Ç –Ü–∑–¥–µ—É',
        'test-completed': '‚úÖ –¢–µ—Å—Ç –ê—è“õ—Ç–∞–ª–¥—ã'
      };
      return types[type] || type;
    }

    formatActivityDetails(item) {
      if (item.type === 'chat') {
        return `<p class="mb-1"><strong>–°“±—Ä–∞“õ:</strong> ${item.details.question || '–ñ–æ“õ'}</p>`;
      } else if (item.type === 'test') {
        return `<p class="mb-1"><strong>–°“±—Ä–∞“õ—Ç–∞—Ä:</strong> ${item.details.questions || '–ñ–æ“õ'}</p>`;
      } else if (item.type === 'content-search') {
        return `<p class="mb-1"><strong>–¢“Ø—Ä—ñ:</strong> ${item.details.contentType || '–ñ–æ“õ'}</p>
                <p class="mb-1"><strong>–†–µ—Å—É—Ä—Å—Ç–∞—Ä:</strong> ${item.details.resources || '–ñ–æ“õ'}</p>`;
      } else if (item.type === 'test-completed') {
        return `<p class="mb-1"><strong>–ë–∞–ª–ª:</strong> ${item.score}%</p>`;
      }
      return '';
    }

    handleLogout() {
      this.currentUser = null;
      this.token = null;
      localStorage.removeItem('aiToolkitUser');
      localStorage.removeItem('aiToolkitToken');
      this.showLoginForm();
      document.getElementById('loginForm').reset();
      this.showMessage('–°”ô—Ç—Ç—ñ —à—ã“õ—Ç—ã“£—ã–∑', 'success');
    }

    checkExistingLogin() {
      const savedUser = localStorage.getItem('aiToolkitUser');
      const savedToken = localStorage.getItem('aiToolkitToken');
      
      if (savedUser && savedToken) {
        this.currentUser = JSON.parse(savedUser);
        this.token = savedToken;
        this.showProfile();
        this.loadUserData();
      }
    }

    saveToLocalStorage() {
      if (this.currentUser && this.token) {
        localStorage.setItem('aiToolkitUser', JSON.stringify(this.currentUser));
        localStorage.setItem('aiToolkitToken', this.token);
      }
    }

    showMessage(message, type) {
      const messageDiv = document.getElementById('authMessage');
      messageDiv.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
      setTimeout(() => {
        messageDiv.innerHTML = '';
      }, 5000);
    }

    static getAuthHeader() {
      const token = localStorage.getItem('aiToolkitToken');
      return token ? { 'Authorization': `Bearer ${token}` } : {};
    }

    static async updateProgress(updates) {
      try {
        const token = localStorage.getItem('aiToolkitToken');
        if (!token) return null;

        const response = await fetch('/api/update-progress', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify(updates)
        });
        
        return await response.json();
      } catch (error) {
        console.error('–ü—Ä–æ–≥—Ä–µ—Å—Ç—ñ –∂–∞“£–∞—Ä—Ç—É “õ–∞—Ç–µ—Å—ñ:', error);
        return null;
      }
    }

    static async addToHistory(type, topic, details, score = null) {
      try {
        const token = localStorage.getItem('aiToolkitToken');
        if (!token) return null;

        const response = await fetch('/api/add-to-history', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({ type, topic, details, score })
        });
        
        return await response.json();
      } catch (error) {
        console.error('–¢–∞—Ä–∏—Ö“õ–∞ “õ–æ—Å—É “õ–∞—Ç–µ—Å—ñ:', error);
        return null;
      }
    }
  }

  // –ë–µ—Ç –∂“Ø–∫—Ç–µ–≥–µ–Ω–¥–µ –∂“Ø–π–µ–Ω—ñ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è–ª–∞—É
  document.addEventListener('DOMContentLoaded', () => {
    window.accountSystem = new AccountSystem();
  });
</script>
</body>
</html> 