<!doctype html>
<html lang="ru">

<head>
  <title>–ê–∫–∫–∞—É–Ω—Ç - Ai-Toolkit</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link href="https://fonts.googleapis.com/css?family=DM+Sans:300,400,700|Indie+Flower" rel="stylesheet">
  
  <link rel="stylesheet" href="fonts/icomoon/style.css">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/bootstrap-datepicker.css">
  <link rel="stylesheet" href="css/jquery.fancybox.min.css">
  <link rel="stylesheet" href="css/owl.carousel.min.css">
  <link rel="stylesheet" href="css/owl.theme.default.min.css">
  <link rel="stylesheet" href="fonts/flaticon/font/flaticon.css">
  <link rel="stylesheet" href="css/aos.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/responsive.css">

  <style>
    .progress-section {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .progress-bar-custom {
      height: 20px;
      border-radius: 10px;
    }
    .history-item {
      border-left: 3px solid #007bff;
      padding-left: 15px;
      margin-bottom: 15px;
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .plan-card {
      border-radius: 10px;
      transition: transform 0.3s;
      margin-bottom: 20px;
    }
    .plan-card:hover {
      transform: translateY(-5px);
    }
    .stats-card {
      text-align: center;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      color: white;
    }
    .login-section, .profile-section {
      display: none;
    }
    .active-section {
      display: block;
    }
    .level-badge {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 5px 15px;
      border-radius: 20px;
      font-weight: bold;
    }
    .goal-item {
      padding: 10px;
      border-bottom: 1px solid #eee;
    }
    .goal-item:last-child {
      border-bottom: none;
    }
    .goal-completed {
      text-decoration: line-through;
      color: #28a745;
    }
    .section-title {
      border-bottom: 2px solid #fd4d40;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }
  </style>
</head>

<body data-spy="scroll" data-target=".site-navbar-target" data-offset="300">
  
  <div class="site-wrap" id="home-section">

     <div class="site-mobile-menu site-navbar-target">
        <div class="site-mobile-menu-header">
          <div class="site-mobile-menu-close mt-3">
            <span class="icon-close2 js-menu-toggle"></span>
          </div>
        </div>
        <div class="site-mobile-menu-body"></div>
     </div>
     
    <header class="site-navbar site-navbar-target" role="banner">
      <div class="container mb-3">
        <div class="d-flex align-items-center">
          <div class="site-logo mr-auto">
            <a href="index_ru.html">Ai-Toolkit<span class="text-primary">.</span></a>
          </div>
          <div class="site-quick-contact d-none d-lg-flex ml-auto ">
            <div class="d-flex site-info align-items-center mr-5">
              <span class="block-icon mr-3"><span class="icon-map-marker text-yellow"></span></span>
              <span>–®–∫–æ–ª–∞ –∏–º–µ–Ω–∏ –®–µ—Ä—Ö–∞–Ω–∞ –ú—É—Ä—Ç–∞–∑—ã <br>–¢–∞—Ä–∞–∑</span>
            </div>
            <div class="d-flex site-info align-items-center">
              <span class="block-icon mr-3"><span class="icon-clock-o"></span></span>
              <span>–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ<br> </span>
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="menu-wrap d-flex align-items-center">
          <span class="d-inline-block d-lg-none"><a href="#" class="text-black site-menu-toggle js-menu-toggle py-5"><span class="icon-menu h3 text-black"></span></a></span>

          <nav class="site-navigation text-left mr-auto d-none d-lg-block" role="navigation">
            <ul class="site-menu main-menu js-clone-nav mr-auto ">
                  <li><a href="index_ru.html" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a></li>
                  <li><a href="chat_ru.html" class="nav-link">AI –ü–æ–º–æ—â–Ω–∏–∫</a></li>
                  <li><a href="test_ru.html" class="nav-link">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¢–µ—Å—Ç–æ–≤</a></li>
                  <li><a href="img_ru.html" class="nav-link">–ü–æ–∏—Å–∫ –ö–æ–Ω—Ç–µ–Ω—Ç–∞</a></li>
                  <li><a href="contact_ru.html" class="nav-link">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                  <li><a href="edu_ru.html" class="nav-link">–û–±—É—á–µ–Ω–∏–µ</a></li>
                  <li class="active"><a href="acc_ru.html" class="nav-link">–ê–∫–∫–∞—É–Ω—Ç</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </header>

    <div class="ftco-blocks-cover-1">
      <div class="site-section-cover overlay" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-md-8 mt-5 pt-5">
              <span class="text-cursive h5 text-white">–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!</span>
              <h1 class="mb-3 font-weight-bold text-white">–í–∞—à–∞ –ü–∞–Ω–µ–ª—å –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –û–±—É—á–µ–Ω–∏–µ–º</h1>
              <p class="text-white">–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —Å–ª–µ–¥—É–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –ø–ª–∞–Ω—É –æ–±—É—á–µ–Ω–∏—è</p>
            </div>
            <div class="col-md-4 ml-auto align-self-end">
              <img src="images/user_dashboard.png" alt="Image" class="img-fluid">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –°–µ–∫—Ü–∏—è –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div class="site-section bg-light login-section active-section" id="login-section">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-md-6">
            <div class="card shadow-sm">
              <div class="card-body p-5">
                <h3 class="text-center mb-4">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Ai-Toolkit</h3>
                
                <div class="text-center mb-4">
                  <button class="btn btn-primary mr-2" id="showLoginBtn">–í–æ–π—Ç–∏</button>
                  <button class="btn btn-outline-primary" id="showRegisterBtn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>

                <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
                <form id="loginForm">
                  <h4 class="text-center mb-4">–í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç</h4>
                  <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-control" id="loginEmail" required>
                  </div>
                  <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" class="form-control" id="loginPassword" required>
                  </div>
                  <button type="submit" class="btn btn-primary btn-block">–í–æ–π—Ç–∏</button>
                </form>

                <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
                <form id="registerForm" style="display: none;">
                  <h4 class="text-center mb-4">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç</h4>
                  <div class="form-group">
                    <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" class="form-control" id="registerUsername" required>
                  </div>
                  <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-control" id="registerEmail" required>
                  </div>
                  <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" class="form-control" id="registerPassword" required>
                  </div>
                  <div class="form-group">
                    <label>–£—Ä–æ–≤–µ–Ω—å –∫–ª–∞—Å—Å–∞</label>
                    <select class="form-control" id="registerGrade">
                      <option value="5">5 –∫–ª–∞—Å—Å</option>
                      <option value="6">6 –∫–ª–∞—Å—Å</option>
                      <option value="7">7 –∫–ª–∞—Å—Å</option>
                    </select>
                  </div>
                  <button type="submit" class="btn btn-primary btn-block">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
                </form>

                <div id="authMessage" class="mt-3"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å–µ–∫—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
    <div class="site-section bg-light profile-section" id="profile-section">
      <div class="container">
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="row mb-5">
          <div class="col-12">
            <h2 class="section-title">–í–∞—à–∞ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
          </div>
          <div class="col-md-3">
            <div class="stats-card bg-primary">
              <h2 id="completedLessons">0</h2>
              <p>–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –£—Ä–æ–∫–∏</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stats-card bg-success">
              <h2 id="averageScore">0%</h2>
              <p>–°—Ä–µ–¥–Ω–∏–π –ë–∞–ª–ª</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stats-card bg-warning text-dark">
              <h2 id="currentStreak">0</h2>
              <p>–¢–µ–∫—É—â–∞—è –°–µ—Ä–∏—è</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stats-card bg-info">
              <h2 id="aiRequestsToday">0</h2>
              <p>AI –ó–∞–ø—Ä–æ—Å–æ–≤ –°–µ–≥–æ–¥–Ω—è</p>
            </div>
          </div>
        </div>

        <!-- –ü—Ä–æ—Ñ–∏–ª—å –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å -->
        <div class="row">
          <div class="col-md-4 mb-4">
            <div class="card shadow-sm">
              <div class="card-body text-center">
                <img src="images/user.jpg" alt="User" class="rounded-circle mb-3" width="120">
                <h3 class="card-title" id="profileUsername">–ó–∞–≥—Ä—É–∑–∫–∞...</h3>
                <p class="text-muted" id="profileEmail">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                <div class="mb-3">
                  <span class="level-badge" id="profileLevel">–£—Ä–æ–≤–µ–Ω—å 1</span>
                  <span class="badge badge-success p-2 ml-1">–ê–∫—Ç–∏–≤–µ–Ω</span>
                </div>
                <div class="progress mb-2">
                  <div class="progress-bar bg-warning" id="experienceBar" role="progressbar" style="width: 0%"></div>
                </div>
                <small class="text-muted" id="experienceText">0/100 XP –¥–æ —Å–ª–µ–¥. —É—Ä–æ–≤–Ω—è</small>
                <p class="card-text mt-3" id="profileJoined">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è: –ó–∞–≥—Ä—É–∑–∫–∞...</p>
                <button class="btn btn-outline-primary btn-sm" id="logoutBtn">–í—ã–π—Ç–∏</button>
              </div>
            </div>
          </div>
          
          <div class="col-md-8">
            <div class="card shadow-sm">
              <div class="card-body">
                <h4 class="section-title">–ü—Ä–æ–≥—Ä–µ—Å—Å –û–±—É—á–µ–Ω–∏—è</h4>
                <div class="row">
                  <div class="col-md-6">
                    <div class="progress-section">
                      <h5>–û—Å–Ω–æ–≤—ã –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è</h5>
                      <div class="progress mb-3">
                        <div class="progress-bar bg-success progress-bar-custom" id="progressProgramming" role="progressbar" style="width: 0%"></div>
                      </div>
                      <p id="progressProgrammingText">–ó–∞–≤–µ—Ä—à–µ–Ω–æ: 0/20 —É—Ä–æ–∫–æ–≤</p>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="progress-section">
                      <h5>–ê–ª–≥–æ—Ä–∏—Ç–º—ã & –°—Ç—Ä—É–∫—Ç—É—Ä—ã –î–∞–Ω–Ω—ã—Ö</h5>
                      <div class="progress mb-3">
                        <div class="progress-bar bg-info progress-bar-custom" id="progressAlgorithms" role="progressbar" style="width: 0%"></div>
                      </div>
                      <p id="progressAlgorithmsText">–ó–∞–≤–µ—Ä—à–µ–Ω–æ: 0/20 —É—Ä–æ–∫–æ–≤</p>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="progress-section">
                      <h5>–í–µ–±-–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞</h5>
                      <div class="progress mb-3">
                        <div class="progress-bar bg-warning progress-bar-custom" id="progressWeb" role="progressbar" style="width: 0%"></div>
                      </div>
                      <p id="progressWebText">–ó–∞–≤–µ—Ä—à–µ–Ω–æ: 0/20 —É—Ä–æ–∫–æ–≤</p>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="progress-section">
                      <h5>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ë–∞–∑–∞–º–∏ –î–∞–Ω–Ω—ã—Ö</h5>
                      <div class="progress mb-3">
                        <div class="progress-bar bg-danger progress-bar-custom" id="progressDatabases" role="progressbar" style="width: 0%"></div>
                      </div>
                      <p id="progressDatabasesText">–ó–∞–≤–µ—Ä—à–µ–Ω–æ: 0/20 —É—Ä–æ–∫–æ–≤</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- –ü–ª–∞–Ω—ã –æ–±—É—á–µ–Ω–∏—è -->
        <div class="row mt-5">
          <div class="col-md-6">
            <div class="card plan-card shadow-sm border-warning">
              <div class="card-header bg-warning text-white">
                <h4 class="mb-0">üìÖ –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –ü–ª–∞–Ω</h4>
              </div>
              <div class="card-body">
                <h5 class="card-title">–¶–µ–ª–∏ –Ω–∞ —ç—Ç—É –Ω–µ–¥–µ–ª—é</h5>
                <div class="progress mb-3">
                  <div class="progress-bar bg-warning" id="weeklyProgress" role="progressbar" style="width: 0%"></div>
                </div>
                <p class="text-muted" id="weeklyProgressText">0% –Ω–µ–¥–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</p>
                
                <div id="weeklyGoalsList">
                  <!-- Goals will be populated by JavaScript -->
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="card plan-card shadow-sm border-danger">
              <div class="card-header bg-danger text-white">
                <h4 class="mb-0">üìä –ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –ü–ª–∞–Ω</h4>
              </div>
              <div class="card-body">
                <h5 class="card-title">–¶–µ–ª–∏ –Ω–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü</h5>
                <div class="progress mb-3">
                  <div class="progress-bar bg-danger" id="monthlyProgress" role="progressbar" style="width: 0%"></div>
                </div>
                <p class="text-muted" id="monthlyProgressText">0% –º–µ—Å—è—á–Ω—ã—Ö —Ü–µ–ª–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</p>
                
                <div id="monthlyGoalsList">
                  <!-- Goals will be populated by JavaScript -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π -->
        <div class="row mt-5">
          <div class="col-12">
            <div class="card shadow-sm">
              <div class="card-body">
                <h4 class="section-title">üìù –ù–µ–¥–∞–≤–Ω—è—è –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h4>
                <div id="historyContainer">
                  <p class="text-muted text-center">–ò—Å—Ç–æ—Ä–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer class="site-footer">
      <div class="container">
        <div class="row">
          <div class="col-lg-4">
            <h2 class="footer-heading mb-3">–û –Ω–∞—Å</h2>
            <p class="mb-5">–õ—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–µ—Ä—è—Ç, —á—Ç–æ –æ–±—É—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–º</p>

            <h2 class="footer-heading mb-4">–†–∞—Å—Å—ã–ª–∫–∞</h2>
            <form action="#" class="d-flex" class="subscribe">
              <input type="text" class="form-control mr-3" placeholder="Email">
              <a type="submit" class="btn btn-primary" href="contact_ru.html" style="align-items: center; padding-top: 15px; ">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</a>
            </form>
          </div>
          <div class="col-lg-8 ml-auto">
            <div class="row">
              <div class="col-lg-4 ml-auto">
                <h2 class="footer-heading mb-4">–ù–∞–≤–∏–≥–∞—Ü–∏—è</h2>
                <ul class="list-unstyled">
                  <li><a href="index_ru.html#Aboutus">–û –Ω–∞—Å</a></li>
                  <li><a href="chat_ru.html">AI –ü–æ–º–æ—â–Ω–∏–∫</a></li>
                  <li><a href="index_ru.html#Testimonials">–û—Ç–∑—ã–≤—ã</a></li>
                  <li><a href="contact_ru.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                  <li><a href="index_ru.html#plan">–ü–ª–∞–Ω</a></li>
                  <li><a href="index_ru.html#functional">–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª</a></li>
                  <li><a href="index_ru.html#pros">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="row pt-5 mt-5 text-center">
          <div class="col-md-12">
            <div class="border-top pt-5">
            </div>
          </div>
        </div>
      </div>
    </footer>
  </div>

  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/jquery-migrate-3.0.0.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/jquery.sticky.js"></script>
  <script src="js/jquery.waypoints.min.js"></script>
  <script src="js/jquery.animateNumber.min.js"></script>
  <script src="js/jquery.fancybox.min.js"></script>
  <script src="js/jquery.stellar.min.js"></script>
  <script src="js/jquery.easing.1.3.js"></script>
  <script src="js/bootstrap-datepicker.min.js"></script>
  <script src="js/aos.js"></script>
  <script src="js/main.js"></script>
  <script src="js/responsive.js"></script>

<script>
  class AccountSystem {
    constructor() {
      this.currentUser = null;
      this.token = null;
      this.init();
    }

    init() {
      this.setupEventListeners();
      this.checkExistingLogin();
    }

    setupEventListeners() {
      document.getElementById('showLoginBtn').addEventListener('click', () => this.showLogin());
      document.getElementById('showRegisterBtn').addEventListener('click', () => this.showRegister());
      document.getElementById('loginForm').addEventListener('submit', (e) => this.handleLogin(e));
      document.getElementById('registerForm').addEventListener('submit', (e) => this.handleRegister(e));
      document.getElementById('logoutBtn').addEventListener('click', () => this.handleLogout());
    }

    showLogin() {
      document.getElementById('loginForm').style.display = 'block';
      document.getElementById('registerForm').style.display = 'none';
      document.getElementById('showLoginBtn').classList.add('btn-primary');
      document.getElementById('showLoginBtn').classList.remove('btn-outline-primary');
      document.getElementById('showRegisterBtn').classList.add('btn-outline-primary');
      document.getElementById('showRegisterBtn').classList.remove('btn-primary');
    }

    showRegister() {
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('registerForm').style.display = 'block';
      document.getElementById('showRegisterBtn').classList.add('btn-primary');
      document.getElementById('showRegisterBtn').classList.remove('btn-outline-primary');
      document.getElementById('showLoginBtn').classList.add('btn-outline-primary');
      document.getElementById('showLoginBtn').classList.remove('btn-primary');
    }

    async handleLogin(e) {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;

      try {
        const response = await fetch('/api/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        });

        const data = await response.json();

        if (data.success) {
          this.currentUser = data.user;
          this.token = data.token;
          this.saveToLocalStorage();
          this.showProfile();
          await this.loadUserData();
          this.showMessage('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
        } else {
          this.showMessage(data.error, 'danger');
        }
      } catch (error) {
        this.showMessage('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ' + error.message, 'danger');
      }
    }

    async handleRegister(e) {
      e.preventDefault();
      const username = document.getElementById('registerUsername').value;
      const email = document.getElementById('registerEmail').value;
      const password = document.getElementById('registerPassword').value;
      const grade = document.getElementById('registerGrade').value;

      try {
        const response = await fetch('/api/register', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, email, password, grade })
        });

        const data = await response.json();

        if (data.success) {
          this.currentUser = data.user;
          this.token = data.token;
          this.saveToLocalStorage();
          this.showProfile();
          await this.loadUserData();
          this.showMessage('–ê–∫–∫–∞—É–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!', 'success');
        } else {
          this.showMessage(data.error, 'danger');
        }
      } catch (error) {
        this.showMessage('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ' + error.message, 'danger');
      }
    }

    showProfile() {
      document.querySelector('.login-section').classList.remove('active-section');
      document.querySelector('.profile-section').classList.add('active-section');
    }

    showLoginForm() {
      document.querySelector('.login-section').classList.add('active-section');
      document.querySelector('.profile-section').classList.remove('active-section');
    }

    async loadUserData() {
      if (!this.currentUser || !this.token) return;

      try {
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const userResponse = await fetch('/api/user', {
          headers: {
            'Authorization': `Bearer ${this.token}`
          }
        });
        
        if (!userResponse.ok) {
          throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
        }
        
        const userData = await userResponse.json();

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Ä–æ–≤–Ω–µ
        const levelResponse = await fetch('/api/level-info', {
          headers: {
            'Authorization': `Bearer ${this.token}`
          }
        });
        
        let levelInfo = {};
        if (levelResponse.ok) {
          levelInfo = await levelResponse.json();
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
        const historyResponse = await fetch('/api/history', {
          headers: {
            'Authorization': `Bearer ${this.token}`
          }
        });
        
        const history = historyResponse.ok ? await historyResponse.json() : [];

        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        this.updateProfileUI(userData, levelInfo);
        this.updateStatsUI(userData.stats);
        this.updateProgressUI(userData.stats);
        this.displayHistory(history);
        this.updateLearningPlans(userData.stats);

      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
        this.showMessage('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ' + error.message, 'danger');
      }
    }

    updateProfileUI(userData, levelInfo) {
      document.getElementById('profileUsername').textContent = userData.username;
      document.getElementById('profileEmail').textContent = userData.email;
      
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Ä–æ–≤–Ω–µ
      const level = levelInfo.level || userData.level || 1;
      const currentExp = levelInfo.currentLevelExp || (userData.experience % 100) || 0;
      const expToNext = levelInfo.expToNextLevel || (100 - currentExp);
      
      document.getElementById('profileLevel').textContent = `–£—Ä–æ–≤–µ–Ω—å ${level}`;
      document.getElementById('profileJoined').textContent = `–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è: ${new Date(userData.joined).toLocaleDateString()}`;
      
      // –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–ø—ã—Ç–∞
      const expPercent = currentExp;
      document.getElementById('experienceBar').style.width = `${expPercent}%`;
      document.getElementById('experienceText').textContent = `${currentExp}/${expToNext + currentExp} XP –¥–æ —Å–ª–µ–¥. —É—Ä–æ–≤–Ω—è`;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      if (this.currentUser) {
        this.currentUser.level = level;
        this.currentUser.experience = userData.experience;
        this.saveToLocalStorage();
      }
    }

    updateStatsUI(stats) {
      // –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —É—Ä–æ–∫–∏
      document.getElementById('completedLessons').textContent = stats.completedLessons || 0;
      
      // –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª
      const averageScore = stats.testsTaken > 0 ? Math.round(stats.totalScore / stats.testsTaken) : 0;
      document.getElementById('averageScore').textContent = `${averageScore}%`;
      
      // –¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è
      document.getElementById('currentStreak').textContent = stats.currentStreak || 0;
      
      // AI –∑–∞–ø—Ä–æ—Å–æ–≤ —Å–µ–≥–æ–¥–Ω—è
      const today = new Date().toDateString();
      const aiRequestsToday = stats.dailyRequests ? (stats.dailyRequests[today] || 0) : 0;
      document.getElementById('aiRequestsToday').textContent = aiRequestsToday;
    }

    updateProgressUI(stats) {
      const progress = stats.progress || {};
      
      // –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ
      const programmingProgress = progress.programming || 0;
      document.getElementById('progressProgramming').style.width = `${programmingProgress}%`;
      document.getElementById('progressProgrammingText').textContent = 
        `–ó–∞–≤–µ—Ä—à–µ–Ω–æ: ${Math.round(programmingProgress / 5)}/20 —É—Ä–æ–∫–æ–≤`;
      
      // –ê–ª–≥–æ—Ä–∏—Ç–º—ã
      const algorithmsProgress = progress.algorithms || 0;
      document.getElementById('progressAlgorithms').style.width = `${algorithmsProgress}%`;
      document.getElementById('progressAlgorithmsText').textContent = 
        `–ó–∞–≤–µ—Ä—à–µ–Ω–æ: ${Math.round(algorithmsProgress / 5)}/20 —É—Ä–æ–∫–æ–≤`;
      
      // –í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
      const webProgress = progress.web || 0;
      document.getElementById('progressWeb').style.width = `${webProgress}%`;
      document.getElementById('progressWebText').textContent = 
        `–ó–∞–≤–µ—Ä—à–µ–Ω–æ: ${Math.round(webProgress / 5)}/20 —É—Ä–æ–∫–æ–≤`;
      
      // –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
      const databasesProgress = progress.databases || 0;
      document.getElementById('progressDatabases').style.width = `${databasesProgress}%`;
      document.getElementById('progressDatabasesText').textContent = 
        `–ó–∞–≤–µ—Ä—à–µ–Ω–æ: ${Math.round(databasesProgress / 5)}/20 —É—Ä–æ–∫–æ–≤`;
    }

    updateLearningPlans(stats) {
      const weeklyProgress = this.calculateWeeklyProgress(stats);
      document.getElementById('weeklyProgress').style.width = `${weeklyProgress}%`;
      document.getElementById('weeklyProgressText').textContent = `${weeklyProgress}% –Ω–µ–¥–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ`;
      
      const monthlyProgress = this.calculateMonthlyProgress(stats);
      document.getElementById('monthlyProgress').style.width = `${monthlyProgress}%`;
      document.getElementById('monthlyProgressText').textContent = `${monthlyProgress}% –º–µ—Å—è—á–Ω—ã—Ö —Ü–µ–ª–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ`;
      
      this.updateGoalsLists(stats);
    }

    calculateWeeklyProgress(stats) {
      const today = new Date();
      let activeDays = 0;
      
      if (stats.dailyRequests) {
        for (let i = 0; i < 7; i++) {
          const date = new Date();
          date.setDate(today.getDate() - i);
          const dateString = date.toDateString();
          if (stats.dailyRequests[dateString] > 0) {
            activeDays++;
          }
        }
      }
      
      return Math.min(100, Math.round((activeDays / 7) * 100));
    }

    calculateMonthlyProgress(stats) {
      const progress = stats.progress || {};
      const totalProgress = (progress.programming || 0) + (progress.algorithms || 0) + 
                          (progress.web || 0) + (progress.databases || 0);
      const maxPossible = 400;
      return Math.round((totalProgress / maxPossible) * 100);
    }

    updateGoalsLists(stats) {
      const weeklyGoals = [
        "–ó–∞–≤–µ—Ä—à–∏—Ç—å –º–∏–Ω–∏–º—É–º 3 —É—Ä–æ–∫–∞ —Å AI-–ø–æ–º–æ—â–Ω–∏–∫–æ–º",
        "–ü—Ä–æ–π—Ç–∏ –æ–¥–∏–Ω –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç",
        "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è",
        "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å 3-–¥–Ω–µ–≤–Ω—É—é —Å–µ—Ä–∏—é –æ–±—É—á–µ–Ω–∏—è"
      ];
      
      const monthlyGoals = [
        "–î–æ—Å—Ç–∏—á—å 5 —É—Ä–æ–≤–Ω—è",
        "–ó–∞–≤–µ—Ä—à–∏—Ç—å –û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è (50%)",
        "–î–æ—Å—Ç–∏—á—å —Å—Ä–µ–¥–Ω–µ–≥–æ –±–∞–ª–ª–∞ 80%",
        "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ AI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ö–æ—Ç—è –±—ã —Ä–∞–∑"
      ];
      
      this.renderGoalsList('weeklyGoalsList', weeklyGoals, this.calculateWeeklyProgress(stats));
      this.renderGoalsList('monthlyGoalsList', monthlyGoals, this.calculateMonthlyProgress(stats));
    }

    renderGoalsList(containerId, goals, progress) {
      const container = document.getElementById(containerId);
      const completedCount = Math.floor((progress / 100) * goals.length);
      
      let html = '';
      goals.forEach((goal, index) => {
        const isCompleted = index < completedCount;
        html += `
          <div class="goal-item ${isCompleted ? 'goal-completed' : ''}">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" ${isCompleted ? 'checked' : ''} disabled>
              <label class="form-check-label">${goal}</label>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    async displayHistory(history) {
      const historyContainer = document.getElementById('historyContainer');
      
      if (history.length === 0) {
        historyContainer.innerHTML = '<p class="text-muted text-center">–ò—Å—Ç–æ—Ä–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç. –ù–∞—á–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤–∞—à—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–¥–µ—Å—å!</p>';
        return;
      }

      let html = '';
      history.slice(0, 10).forEach(item => {
        const date = new Date(item.timestamp);
        const timeString = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
        
        html += `
          <div class="history-item">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <strong>${this.getActivityType(item.type)}</strong>
                <p class="mb-1"><strong>–¢–µ–º–∞:</strong> ${item.topic}</p>
                ${this.formatActivityDetails(item)}
              </div>
              <small class="text-muted">${timeString}</small>
            </div>
          </div>
        `;
      });

      historyContainer.innerHTML = html;
    }

    getActivityType(type) {
      const types = {
        'chat': 'ü§ñ –ß–∞—Ç —Å AI –ü–æ–º–æ—â–Ω–∏–∫–æ–º',
        'test': 'üìù –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –¢–µ—Å—Ç',
        'content-search': 'üîç –ü–æ–∏—Å–∫ –ö–æ–Ω—Ç–µ–Ω—Ç–∞',
        'test-completed': '‚úÖ –¢–µ—Å—Ç –ó–∞–≤–µ—Ä—à–µ–Ω'
      };
      return types[type] || type;
    }

    formatActivityDetails(item) {
      if (item.type === 'chat') {
        return `<p class="mb-1"><strong>–í–æ–ø—Ä–æ—Å:</strong> ${item.details.question || '–ù/–î'}</p>`;
      } else if (item.type === 'test') {
        return `<p class="mb-1"><strong>–í–æ–ø—Ä–æ—Å—ã:</strong> ${item.details.questions || '–ù/–î'}</p>`;
      } else if (item.type === 'content-search') {
        return `<p class="mb-1"><strong>–¢–∏–ø:</strong> ${item.details.contentType || '–ù/–î'}</p>
                <p class="mb-1"><strong>–†–µ—Å—É—Ä—Å—ã:</strong> ${item.details.resources || '–ù/–î'}</p>`;
      } else if (item.type === 'test-completed') {
        return `<p class="mb-1"><strong>–ë–∞–ª–ª:</strong> ${item.score}%</p>`;
      }
      return '';
    }

    handleLogout() {
      this.currentUser = null;
      this.token = null;
      localStorage.removeItem('aiToolkitUser');
      localStorage.removeItem('aiToolkitToken');
      this.showLoginForm();
      document.getElementById('loginForm').reset();
      this.showMessage('–í—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
    }

    checkExistingLogin() {
      const savedUser = localStorage.getItem('aiToolkitUser');
      const savedToken = localStorage.getItem('aiToolkitToken');
      
      if (savedUser && savedToken) {
        this.currentUser = JSON.parse(savedUser);
        this.token = savedToken;
        this.showProfile();
        this.loadUserData();
      }
    }

    saveToLocalStorage() {
      if (this.currentUser && this.token) {
        localStorage.setItem('aiToolkitUser', JSON.stringify(this.currentUser));
        localStorage.setItem('aiToolkitToken', this.token);
      }
    }

    showMessage(message, type) {
      const messageDiv = document.getElementById('authMessage');
      messageDiv.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
      setTimeout(() => {
        messageDiv.innerHTML = '';
      }, 5000);
    }

    static getAuthHeader() {
      const token = localStorage.getItem('aiToolkitToken');
      return token ? { 'Authorization': `Bearer ${token}` } : {};
    }

    static async updateProgress(updates) {
      try {
        const token = localStorage.getItem('aiToolkitToken');
        if (!token) return null;

        const response = await fetch('/api/update-progress', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify(updates)
        });
        
        return await response.json();
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:', error);
        return null;
      }
    }

    static async addToHistory(type, topic, details, score = null) {
      try {
        const token = localStorage.getItem('aiToolkitToken');
        if (!token) return null;

        const response = await fetch('/api/add-to-history', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({ type, topic, details, score })
        });
        
        return await response.json();
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∏—Å—Ç–æ—Ä–∏—é:', error);
        return null;
      }
    }
  }

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  document.addEventListener('DOMContentLoaded', () => {
    window.accountSystem = new AccountSystem();
  });
</script>
</body>
</html>