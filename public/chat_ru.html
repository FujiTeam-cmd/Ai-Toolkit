<!DOCTYPE html>
<html lang="ru">
  <head>
    <title>AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç - Ai-Toolkit</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css?family=DM+Sans:300,400,700|Indie+Flower" rel="stylesheet">
    

    <link rel="stylesheet" href="fonts/icomoon/style.css">

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="css/jquery.fancybox.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">
    <link rel="stylesheet" href="fonts/flaticon/font/flaticon.css">
    <link rel="stylesheet" href="css/aos.css">
    <link rel="stylesheet" href="css/responsive.css">

    <!-- MAIN CSS -->
    <link rel="stylesheet" href="css/style.css">

    <style>
      /* Chat specific styles */
      .chat-container {
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 5px 15px -5px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        height: 70vh;
        display: flex;
        flex-direction: column;
      }
      
      .chat-header {
        background: #fd4d40;
        color: white;
        padding: 1rem;
        text-align: center;
      }
      
      .chat-messages {
        flex: 1;
        padding: 1.5rem;
        overflow-y: auto;
        background-color: #f8f9fa;
      }
      
      .message {
        margin-bottom: 1rem;
        display: flex;
      }
      
      .user-message {
        justify-content: flex-end;
      }
      
      .bot-message {
        justify-content: flex-start;
      }
      
      .message-bubble {
        max-width: 70%;
        padding: 0.75rem 1rem;
        border-radius: 18px;
        position: relative;
      }
      
      .user-message .message-bubble {
        background-color: #fd4d40;
        color: white;
        border-bottom-right-radius: 4px;
      }
      
      .bot-message .message-bubble {
        background-color: white;
        color: #333;
        border-bottom-left-radius: 4px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      }
      
      .message-time {
        font-size: 0.7rem;
        opacity: 0.7;
        margin-top: 0.25rem;
      }
      
      .chat-input-container {
        display: flex;
        padding: 1rem;
        background-color: white;
        border-top: 1px solid #eee;
      }
      
      .chat-input {
        flex: 1;
        padding: 0.75rem 1rem;
        border: 1px solid #ddd;
        border-radius: 25px;
        outline: none;
        font-size: 1rem;
      }
      
      .chat-input:focus {
        border-color: #fd4d40;
      }
      
      .send-button {
        background-color: #fd4d40;
        color: white;
        border: none;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        margin-left: 0.5rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.3s;
      }
      
      .send-button:hover {
        background-color: #e04438;
      }
      
      .typing-indicator {
        display: none;
        padding: 0.75rem 1rem;
        background-color: white;
        border-radius: 18px;
        border-bottom-left-radius: 4px;
        max-width: 70%;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      }
      
      .typing-dots {
        display: flex;
      }
      
      .typing-dots span {
        height: 8px;
        width: 8px;
        background-color: #bbb;
        border-radius: 50%;
        display: inline-block;
        margin: 0 2px;
        animation: typing 1.4s infinite ease-in-out;
      }
      
      .typing-dots span:nth-child(1) {
        animation-delay: 0s;
      }
      
      .typing-dots span:nth-child(2) {
        animation-delay: 0.2s;
      }
      
      .typing-dots span:nth-child(3) {
        animation-delay: 0.4s;
      }
      
      @keyframes typing {
        0%, 60%, 100% {
          transform: translateY(0);
        }
        30% {
          transform: translateY(-5px);
        }
      }
      
      .auth-indicator {
        position: fixed;
        top: 100px;
        right: 20px;
        background: #28a745;
        color: white;
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 14px;
        z-index: 1000;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
      
      .login-prompt {
        text-align: center;
        padding: 20px;
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        border-radius: 10px;
        margin-bottom: 20px;
      }
    </style>
  </head>

  <body data-spy="scroll" data-target=".site-navbar-target" data-offset="300" style="background-color: #B2B2B2;">

    
    <div class="site-wrap" id="home-section">

      <div class="site-mobile-menu site-navbar-target">
        <div class="site-mobile-menu-header">
          <div class="site-mobile-menu-close mt-3">
            <span class="icon-close2 js-menu-toggle"></span>
          </div>
        </div>
        <div class="site-mobile-menu-body"></div>
      </div>

      <header class="site-navbar site-navbar-target" role="banner">

        <div class="container mb-3">
          <div class="d-flex align-items-center">
            <div class="site-logo mr-auto">
              <a href="index_ru.html">Ai-Toolkit<span class="text-primary">.</span></a>
            </div>
            <div class="site-quick-contact d-none d-lg-flex ml-auto ">
              <div class="d-flex site-info align-items-center mr-5">
                <span class="block-icon mr-3"><span class="icon-map-marker text-yellow"></span></span>
                <span>–®–∫–æ–ª–∞ –∏–º–µ–Ω–∏ –®–µ—Ä—Ö–∞–Ω–∞ –ú—É—Ä—Ç–∞–∑—ã <br>–¢–∞—Ä–∞–∑</span>
              </div>
              <div class="d-flex site-info align-items-center">
                <span class="block-icon mr-3"><span class="icon-clock-o"></span></span>
                <span>–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</span>
              </div>
              
            </div>
          </div>
        </div>

        <div class="container">
          <div class="menu-wrap d-flex align-items-center">
            <span class="d-inline-block d-lg-none"><a href="#" class="text-black site-menu-toggle js-menu-toggle py-5"><span class="icon-menu h3 text-black"></span></a></span>

              <nav class="site-navigation text-left mr-auto d-none d-lg-block" role="navigation">
                <ul class="site-menu main-menu js-clone-nav mr-auto ">
                  <li><a href="index_ru.html" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a></li>
                  <li class="active"><a href="chat_ru.html" class="nav-link">AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</a></li>
                  <li><a href="test_ru.html" class="nav-link">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤</a></li>
                  <li><a href="img_ru.html" class="nav-link">–ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</a></li>
                  <li><a href="contact_ru.html" class="nav-link">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                  <li><a href="edu_ru.html" class="nav-link">–û–±—É—á–µ–Ω–∏–µ</a></li>
                  <li><a href="acc_ru.html" class="nav-link">–ê–∫–∫–∞—É–Ω—Ç</a></li>
                </ul>
              </nav>
          </div>
        </div>
      </header>

      <div style="background-color: #B2B2B2; margin-top: 200px;" id="assistant-section">
        <div class="container">
          <div class="row mb-5">
            <div class="col-12 text-center">
              <span class="text-cursive h5 text-red d-block">AI –£—á–µ–±–Ω—ã–π –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</span>
              <h2 class="text-black">–°–ø—Ä–æ—Å–∏—Ç–µ –º–µ–Ω—è –æ —á–µ–º —É–≥–æ–¥–Ω–æ –≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –Ω–∞—É–∫–∞—Ö</h2>
              <p class="lead">–Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å –≤–∞–º –∏–∑—É—á–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –≤—Å–µ, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–º–∏ –Ω–∞—É–∫–∞–º–∏!</p>
            </div>
          </div>
          
          <!-- Auth Indicator -->
          <div id="authIndicatorContainer"></div>
          
          <div class="row justify-content-center">
            <div class="col-lg-10">
              <div class="chat-container">
                <div class="chat-header">
                  <h3 class="text-white m-0">AI –£—á–µ–±–Ω—ã–π –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</h3>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                  <div class="message bot-message">
                    <div class="message-bubble">
                      <p>–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à AI —É—á–µ–±–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –Ø –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–º–∏ –Ω–∞—É–∫–∞–º–∏, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ –∏ –¥—Ä—É–≥–∏–º–∏ —à–∫–æ–ª—å–Ω—ã–º–∏ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏. –ß–µ–º—É –±—ã –≤—ã —Ö–æ—Ç–µ–ª–∏ –Ω–∞—É—á–∏—Ç—å—Å—è —Å–µ–≥–æ–¥–Ω—è?</p>
                      <div class="message-time">–¢–æ–ª—å–∫–æ —á—Ç–æ</div>
                    </div>
                  </div>
                </div>
                
                <div class="typing-indicator" id="typingIndicator">
                  <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                  </div>
                </div>
                
                <div class="chat-input-container">
                  <input type="text" class="chat-input" id="chatInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å –æ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –Ω–∞—É–∫–∞—Ö –∑–¥–µ—Å—å...">
                  <button class="send-button" id="sendButton">
                    <span class="icon-send"></span>
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <div class="row mt-5">
            <div class="col-md-4 text-center">
              <div class="block-2 red">
                <span class="wrap-icon">
                  <span class="icon-help"></span>
                </span>
                <h2>–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ø–æ–º–æ—â—å</h2>
                <p>–ü–æ–ª—É—á–∞–π—Ç–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é</p>
              </div>
            </div>
            <div class="col-md-4 text-center">
              <div class="block-2 yellow">
                <span class="wrap-icon">
                  <span class="icon-code"></span>
                </span>
                <h2>–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞</h2>
                <p>–£—á–∏—Ç–µ—Å—å —Å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è</p>
              </div>
            </div>
            <div class="col-md-4 text-center">
              <div class="block-2 teal">
                <span class="wrap-icon">
                  <span class="icon-school"></span>
                </span>
                <h2>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —É—á–µ–±–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã</h2>
                <p>–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—à–µ–π —à–∫–æ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ –ø–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–º –Ω–∞—É–∫–∞–º</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="site-section bg-white" id="features">
        <div class="container">
          <div class="row mb-5">
            <div class="col-12 text-center">
              <span class="text-cursive h5 text-red d-block">–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</span>
              <h2 class="text-black">–ò–∑—É—á–∞–π—Ç–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏ —Å AI</h2>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-4 mb-4 mb-lg-0">
              <div class="package text-center bg-light">
                <span class="img-wrap"><img src="images/flaticon/svg/001-jigsaw.svg" alt="Image" class="img-fluid"></span>
                <h3 class="text-teal">–ö–æ–Ω—Ü–µ–ø—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
                <p>–ü–æ–π–º–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ü–∏–∫–ª—ã, —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —á–µ—Ç–∫–∏–º–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏</p>
              </div>
            </div>
            <div class="col-lg-4 mb-4 mb-lg-0">
              <div class="package text-center bg-light">
                <span class="img-wrap"><img src="images/flaticon/svg/002-target.svg" alt="Image" class="img-fluid"></span>
                <h3 class="text-success">–ü–æ–º–æ—â—å —Å –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏</h3>
                <p>–£–∑–Ω–∞–π—Ç–µ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –∫–∞–∫ —Ä–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —à–∞–≥ –∑–∞ —à–∞–≥–æ–º</p>
              </div>
            </div>
            <div class="col-lg-4 mb-4 mb-lg-0">
              <div class="package text-center bg-light">
                <span class="img-wrap"><img src="images/flaticon/svg/003-mission.svg" alt="Image" class="img-fluid"></span>
                <h3 class="text-danger">–í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞</h3>
                <p>–ü–æ–ª—É—á–∏—Ç–µ –ø–æ–º–æ—â—å —Å HTML, CSS, JavaScript –∏ —Å–æ–∑–¥–∞–Ω–∏–µ–º –≤–∞—à–∏—Ö –ø–µ—Ä–≤—ã—Ö –≤–µ–±-—Å–∞–π—Ç–æ–≤</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="site-section py-5 bg-warning">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-md-12 d-flex">
            <h2 class="text-white m-0">–ü—Ä–∏–≤–Ω–µ—Å–∏—Ç–µ –≤–µ—Å–µ–ª—å–µ –≤ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–º –Ω–∞—É–∫–∞–º</h2>
            <a href="#assistant-section" class="btn btn-primary btn-custom-1 py-3 px-5 ml-auto">–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å</a>
            </div>
          </div>
        </div>
      </div>

      <footer class="site-footer">
        <div class="container">
          <div class="row">
            <div class="col-lg-4">
              <h2 class="footer-heading mb-3">–û –Ω–∞—Å</h2>
                  <p class="mb-5">–õ—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–µ—Ä—è—Ç, —á—Ç–æ –∏–∑—É—á–µ–Ω–∏–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –Ω–∞—É–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–µ—Å–µ–ª—ã–º –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è –≤—Å–µ—Ö</p>

                  <h2 class="footer-heading mb-4">–†–∞—Å—Å—ã–ª–∫–∞</h2>
                  <form action="#" class="d-flex" class="subscribe">
                    <input type="text" class="form-control mr-3" placeholder="Email">
                    <input type="submit" class="btn btn-primary" value="–û—Ç–ø—Ä–∞–≤–∏—Ç—å">
                  </form>
            </div>
            <div class="col-lg-8 ml-auto">
              <div class="row">
                <div class="col-lg-4 ml-auto">
                  <h2 class="footer-heading mb-4">–ù–∞–≤–∏–≥–∞—Ü–∏—è</h2>
                  <ul class="list-unstyled">
                  <li><a href="index_ru.html" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a></li>
                  <li class="active"><a href="chat_ru.html" class="nav-link">AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</a></li>
                  <li><a href="test_ru.html" class="nav-link">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤</a></li>
                  <li><a href="img_ru.html" class="nav-link">–ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</a></li>
                  <li><a href="contact_ru.html" class="nav-link">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                  <li><a href="edu_ru.html" class="nav-link">–û–±—É—á–µ–Ω–∏–µ</a></li>
                  <li><a href="acc_ru.html" class="nav-link">–ê–∫–∫–∞—É–Ω—Ç</a></li>
                  </ul>
                </div>
                <div class="col-lg-4">
                  <h2 class="footer-heading mb-4">AI –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h2>
                  <ul class="list-unstyled">
                    <li><a href="#assistant-section">–ß–∞—Ç —Å–µ–π—á–∞—Å</a></li>
                    <li><a href="#features">–§—É–Ω–∫—Ü–∏–∏</a></li>
                    <li><a href="#">–ü–æ–º–æ—â—å –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é</a></li>
                    <li><a href="#">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="row pt-5 mt-5 text-center">
            <div class="col-md-12">
              <div class="border-top pt-5">
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/jquery-migrate-3.0.0.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.sticky.js"></script>
    <script src="js/jquery.waypoints.min.js"></script>
    <script src="js/jquery.animateNumber.min.js"></script>
    <script src="js/jquery.fancybox.min.js"></script>
    <script src="js/jquery.stellar.min.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>
    <script src="js/bootstrap-datepicker.min.js"></script>
    <script src="js/aos.js"></script>
    <script src="js/responsive.js"></script>
    <script src="js/main.js"></script>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const sendButton = document.getElementById('sendButton');
        const typingIndicator = document.getElementById('typingIndicator');
        const authIndicatorContainer = document.getElementById('authIndicatorContainer');
        
        const SERVER_API_URL = '/api/chat';
        
        let conversationHistory = [
          {
            role: "user",
            parts: [{text: "–í—ã - AI —É—á–µ–±–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π—Å—è –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –Ω–∞—É–∫–∞—Ö, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏, –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —à–∫–æ–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–∞—Ö. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –ø–æ–ª–µ–∑–Ω—ã–µ, –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å —Å—Ç—É–¥–µ–Ω—Ç–∞–º —É—á–∏—Ç—å—Å—è. –î–µ—Ä–∂–∏—Ç–µ –æ—Ç–≤–µ—Ç—ã –∫—Ä–∞—Ç–∫–∏–º–∏ –∏ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–Ω—ã–º–∏ –Ω–∞ –æ–±—É—á–µ–Ω–∏–∏."}]
          },
          {
            role: "model", 
            parts: [{text: "–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à AI —É—á–µ–±–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –Ø –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–º–∏ –Ω–∞—É–∫–∞–º–∏, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ –∏ –¥—Ä—É–≥–∏–º–∏ —à–∫–æ–ª—å–Ω—ã–º–∏ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏. –ß–µ–º—É –±—ã –≤—ã —Ö–æ—Ç–µ–ª–∏ –Ω–∞—É—á–∏—Ç—å—Å—è —Å–µ–≥–æ–¥–Ω—è?"}]
          }
        ];
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function checkAuth() {
          const token = localStorage.getItem('token');
          const user = localStorage.getItem('aiToolkitUser');
          return { isAuthenticated: !!(token && user), user: user ? JSON.parse(user) : null };
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function showAuthIndicator() {
          const auth = checkAuth();
          if (auth.isAuthenticated && auth.user) {
            authIndicatorContainer.innerHTML = `
              <div class="auth-indicator">
                üë§ ${auth.user.username} (–£—Ä–æ–≤–µ–Ω—å ${auth.user.level})
                <button onclick="logout()" class="btn btn-sm btn-outline-light ml-2" style="padding: 2px 8px; font-size: 12px;">
                  –í—ã–π—Ç–∏
                </button>
              </div>
            `;
          } else {
            authIndicatorContainer.innerHTML = `
              <div class="login-prompt">
                üí° <strong>–•–æ—Ç–∏—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å?</strong> 
                <a href="acc_ru.html" class="btn btn-primary btn-sm ml-2">–í–æ–π—Ç–∏ –∏–ª–∏ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
              </div>
            `;
          }
        }
        
        // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        window.logout = function() {
          localStorage.removeItem('token');
          localStorage.removeItem('aiToolkitUser');
          showAuthIndicator();
          location.reload();
        };
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
        function addMessage(text, isUser) {
          const messageDiv = document.createElement('div');
          messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
          
          const bubbleDiv = document.createElement('div');
          bubbleDiv.className = 'message-bubble';
          
          const messageText = document.createElement('p');
          messageText.textContent = text;
          
          const timeDiv = document.createElement('div');
          timeDiv.className = 'message-time';
          timeDiv.textContent = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
          
          bubbleDiv.appendChild(messageText);
          bubbleDiv.appendChild(timeDiv);
          messageDiv.appendChild(bubbleDiv);
          
          chatMessages.appendChild(messageDiv);
          chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –æ—Ç AI
        async function getAIResponse(userMessage) {
          try {
            conversationHistory.push({
              role: "user",
              parts: [{text: userMessage}]
            });
            
            const response = await fetch(SERVER_API_URL, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                messages: conversationHistory
              })
            });
            
            if (!response.ok) {
              throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${response.status}`);
            }
            
            const data = await response.json();
            
            if (data.choices && data.choices[0] && data.choices[0].message) {
              const aiResponse = data.choices[0].message.content;
              
              conversationHistory.push({
                role: "model",
                parts: [{text: aiResponse}]
              });
              
              return aiResponse;
            } else {
              throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞');
            }
          } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤—ã–∑–æ–≤–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ API:', error);
            return "–ò–∑–≤–∏–Ω–∏—Ç–µ, —É –º–µ–Ω—è —Å–µ–π—á–∞—Å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.";
          }
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        async function sendMessage() {
          const message = chatInput.value.trim();
          
          if (message) {
            addMessage(message, true);
            chatInput.value = '';
            
            sendButton.disabled = true;
            chatInput.disabled = true;
            
            typingIndicator.style.display = 'block';
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            try {
              const response = await getAIResponse(message);
              
              typingIndicator.style.display = 'none';
              addMessage(response, false);
              
              // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
              const auth = checkAuth();
              if (auth.isAuthenticated) {
                try {
                  const token = localStorage.getItem('token');
                  await fetch('/api/update-progress', {
                    method: 'POST',
                    headers: {
                      'Content-Type': 'application/json',
                      'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                      aiRequests: 1
                    })
                  });
                } catch (statsError) {
                  console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:', statsError);
                }
              }
              
            } catch (error) {
              typingIndicator.style.display = 'none';
              addMessage("–ò–∑–≤–∏–Ω–∏—Ç–µ, —è —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –æ—à–∏–±–∫–æ–π –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.", false);
            } finally {
              sendButton.disabled = false;
              chatInput.disabled = false;
              chatInput.focus();
            }
          }
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        sendButton.addEventListener('click', sendMessage);
        
        chatInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            sendMessage();
          }
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        showAuthIndicator();
        chatInput.focus();
        
        // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–º–µ—Ä—ã –±—ã—Å—Ç—Ä—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
        setTimeout(() => {
          const quickQuestions = [
            "–ß—Ç–æ —Ç–∞–∫–æ–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏?",
            "–û–±—ä—è—Å–Ω–∏—Ç–µ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Ü–∏–∫–ª—ã",
            "–î–ª—è —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTML?",
            "–ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –≤ JavaScript?"
          ];
          
          const examplesContainer = document.createElement('div');
          examplesContainer.style.padding = '1rem';
          examplesContainer.style.textAlign = 'center';
          examplesContainer.innerHTML = `
            <p class="text-muted mb-2">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–ø—Ä–æ—Å–∏—Ç—å:</p>
            <div class="quick-questions">
              ${quickQuestions.map(question => 
                `<button class="btn btn-outline-primary btn-sm m-1" onclick="document.getElementById('chatInput').value='${question}'; document.getElementById('sendButton').click();">${question}</button>`
              ).join('')}
            </div>
          `;
          
          chatMessages.appendChild(examplesContainer);
          chatMessages.scrollTop = chatMessages.scrollHeight;
        }, 2000);
      });
    </script>
  </body>
</html>